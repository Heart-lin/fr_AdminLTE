<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>AdminLTE 2 | system</title>
		<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
		<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
		<link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
		<link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
		<link rel="stylesheet" href="plugins/iCheck/all.css">
		<link rel="stylesheet" href="dist/css/AdminLTE.min.css">
		<link rel="stylesheet" href="dist/css/skins/skin-blue.min.css">
		<link rel="stylesheet" href="css/fr_card.css">
		<link rel="stylesheet" href="css/fr_style.css">
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
		<link rel="stylesheet" href="bower_components/datatables.net-bs/css/dataTables.bootstrap.min.css">
		<style>
			table td {
				padding: 10px;
			}
			
			.box-body {
				padding-top: 10px;
			}
			
			table input[type=tel] {
				width: 60px;
				padding: 10px;
				height: 40px;
				text-align: right;
			}
			
			input[type=tel] {
				display: inline-block;
				width: 100px;
			}
			
			.form-group>label {
				margin: 0 20px;
			}
			
			#msg {
				background-color: #F012BE;
				height: 100px;
			}
		</style>
	</head>

	<body class="hold-transition skin-blue sidebar-mini">
		<div class="wrapper">
			<div class="content-wrapper">
				<section class="content-header ">
					<ol class="breadcrumb">
						<li>
							<a href="#"><i class="fa fa-dashboard"></i>系统管理</a>
						</li>
						<li class="active">系统设置</li>
					</ol>
				</section>
				<section class="content">
					<div class="box box-primary">

						<div class="about_card">
							<div class="details_card">
								<div class="box-body">
									<div class="fr_title">领导人奖励设置</div>
									<table style="width:100%" border="1" cellspacing="0" cellpadding="0" id="incomeSettingInfo">
										<tr>
											<td>直推人数</td>
											<td>一代抽成</td>
											<td>二代抽成</td>
											<td>三代抽成</td>
											<td>四代抽成</td>
											<td>五代抽成</td>
											<td>六代抽成</td>
										</tr>
										<tr>
											<td><input type="tel" name="pushCount" />人</td>
											<td><input type="tel" name="incomeRate1" />%</td>
											<td></td>
											<td></td>
											<td></td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td><input type="tel" name="pushCount" />人</td>
											<td><input type="tel" name="incomeRate1" />%</td>
											<td><input type="tel" name="incomeRate2" />%</td>
											<td></td>
											<td></td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td><input type="tel" name="pushCount" />人</td>
											<td><input type="tel" name="incomeRate1" />%</td>
											<td><input type="tel" name="incomeRate2" />%</td>
											<td><input type="tel" name="incomeRate3" />%</td>
											<td></td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td><input type="tel" name="pushCount" />人</td>
											<td><input type="tel" name="incomeRate1" />%</td>
											<td><input type="tel" name="incomeRate2" />%</td>
											<td><input type="tel" name="incomeRate3" />%</td>
											<td><input type="tel" name="incomeRate4" />%</td>
											<td></td>
											<td></td>
										</tr>
										<tr>
											<td><input type="tel" name="pushCount" />人</td>
											<td><input type="tel" name="incomeRate1" />%</td>
											<td><input type="tel" name="incomeRate2" />%</td>
											<td><input type="tel" name="incomeRate3" />%</td>
											<td><input type="tel" name="incomeRate4" />%</td>
											<td><input type="tel" name="incomeRate5" />%</td>
											<td></td>
										</tr>
										<tr>
											<td><input type="tel" name="pushCount" />人</td>
											<td><input type="tel" name="incomeRate1" />%</td>
											<td><input type="tel" name="incomeRate2" />%</td>
											<td><input type="tel" name="incomeRate3" />%</td>
											<td><input type="tel" name="incomeRate4" />%</td>
											<td><input type="tel" name="incomeRate5" />%</td>
											<td><input type="tel" name="incomeRate6" />%</td>
										</tr>
									</table>

								</div>
							</div>
						</div>
						<div class="box-body">
							<div class="fr_title">无法注册通知</div>
							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-5">
									<label for="leaderUserIncomeRate" class="col-sm-3 control-label" style="line-height:34px;">关闭注册通知</label>
									<div class="col-sm-9">
										<textarea type="tel" class="form-control" id="closePoint" placeholder=""></textarea>
									</div>
								</div>
							</div>
							<div class="row" style="margin-top:15px;">
								<div class="col-xs-5">
									<div class="form-group" >
										<div class="col-sm-3 control-label">
											<label>是否开启注册<label>
										</div>
										<div class="col-sm-9">
											<label style="line-height:20px;margin:0 20px;">
								                  <input type="radio" name="isOpenRegister" class="flat-red" value="1">  开启
								            </label>
											<label style="line-height:20px;">
								                <input type="radio" name="isOpenRegister" class="flat-red" value="-1">  关闭
								            </label>
										</div>
									</div>
								</div>
							</div>
						</div>

						<div class="box-body">
							<div class="fr_title">订单归属人奖励比例</div>
							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="leaderUserIncomeRate" class="col-sm-2 control-label" style="line-height:34px;">比例</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="belongUserIncomeRate" placeholder="">%
									</div>
								</div>
							</div>
						</div>
						
						<div class="box-body">
							<div class="fr_title">订单超时</div>
							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="outTime" class="col-sm-2 control-label" style="line-height:34px;">时间</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="outTime" name="outTime" placeholder="">分钟
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;margin:0 20px;">
						                  <input type="radio" name="isOpenOutTime" class="flat-red" value="1">  开启
						                </label>
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenOutTime" class="flat-red" value="-1">  关闭
						                </label>
									</div>
								</div>
							</div>
						</div>

						<div class="box-body">
							<div class="fr_title">领导人奖励比例</div>
							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="leaderUserIncomeRate" class="col-sm-2 control-label" style="line-height:34px;">比例</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="leaderUserIncomeRate" placeholder="">%
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;margin:0 20px;">
						                  <input type="radio" name="isOpenLeaderUserIncome" class="flat-red" value="1">  开启
						                </label>
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenLeaderUserIncome" class="flat-red" value="-1">  关闭
						                </label>
									</div>
								</div>
							</div>
						</div>
						<div class="box-body">
							<div class="fr_title">转账手续费设置</div>
							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="transferFee" class="col-sm-2 control-label" style="line-height:34px;">金额</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="transferFee" name="transferFee" placeholder="">元
									</div>
								</div>
							</div>
						</div>
						<div class="box-body">
							<div class="fr_title">激活账号金额设置</div>

							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="activeMoney" class="col-sm-2 control-label" style="line-height:34px;">金额</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="activeMoney" placeholder="">元
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenActiveMoney" class="flat-red" value="1">  开启
						                </label>

										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenActiveMoney" class="flat-red" value="-1">  关闭
						                </label>
									</div>
								</div>
							</div>
						</div>

						<div class="box-body">
							<div class="fr_title">最低充值金额设置</div>

							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="minRechargeMoney" class="col-sm-2 control-label" style="line-height:34px;">金额</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="minRechargeMoney" placeholder="">元
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenMinRechargeMoney" class="flat-red" value="1">  开启
						                </label>

										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenMinRechargeMoney" class="flat-red" value="-1">  关闭
						                </label>
									</div>
								</div>
							</div>
						</div>

						<div class="box-body">
							<div class="fr_title">收益转信用最低金额设置</div>

							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="incomeMinMoney" class="col-sm-2 control-label" style="line-height:34px;">金额</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="incomeMinMoney" placeholder="">元
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenMinIncomeToCreditMoney" class="flat-red" value="1">  开启
						                </label>

										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenMinIncomeToCreditMoney" class="flat-red" value="-1">  关闭
						                </label>
									</div>
								</div>
							</div>
						</div>

						<div class="box-body">
							<div class="fr_title">提现最低金额设置</div>
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="minDrawMoney" class="col-sm-2 control-label" style="line-height:34px;">金额</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="minDrawMoney" placeholder="">元
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenMinDrawMoney" class="flat-red" value="1">  开启
						                </label>

										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenMinDrawMoney" class="flat-red" value="-1"> 关闭
						                </label>
									</div>
								</div>
							</div>
						</div>
						<div class="box-body">
							<div class="fr_title">提现手续费</div>
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="minDrawMoney" class="col-sm-2 control-label" style="line-height:34px;">金额</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="drawHandlingFee" placeholder="">元
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenDrawHandlingFee" class="flat-red" value="1">  开启
						                </label>

										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenDrawHandlingFee" class="flat-red" value="-1"> 关闭
						                </label>
									</div>
								</div>
							</div>
						</div>
						<div class="box-body">
							<div class="fr_title">收益分配最低信用点</div>

							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-3">
									<label for="hasIncomeMoneyCredit" class="col-sm-2 control-label" style="line-height:34px;">金额</label>
									<div class="col-sm-10">
										<input type="tel" class="form-control" id="hasIncomeMoneyCredit" placeholder="">元
									</div>
								</div>
								<div class="col-xs-12">
									<div class="form-group" style="margin-top:10px;">
										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenHasIncomeMinMoney" class="flat-red" value="1">  开启
						                </label>

										<label style="line-height:20px;">
						                  <input type="radio" name="isOpenHasIncomeMinMoney" class="flat-red" value="-1">  关闭
						                </label>
									</div>
								</div>
							</div>
						</div>
						<div class="box-body">
							<div class="fr_title">可用类型设置</div>

							<!-- /.box-tools -->
						</div>
						<div class="box-body">
							<div class="row">
								<div class="col-xs-12">
									<div class="col-xs-6">
										<label for="" class="col-sm-2 control-label" style="line-height:34px;">可用收款码类型</label>
										<div class="col-sm-10">
											<div class="form-group" style="margin-top:10px;">
												<label style="line-height:20px;">
								                  <input type="checkbox" name="codeType" class="flat-red" value="1">  支付宝个码
								                </label>

												<label style="line-height:20px;">
								                  <input type="checkbox" name="codeType" class="flat-red" value="2">  微信个码
								                </label>
								                <label style="line-height:20px;">
								                  <input type="checkbox" name="codeType" class="flat-red" value="3">  银行卡
								                </label>
								                <label style="line-height:20px;">
								                  <input type="checkbox" name="codeType" class="flat-red" value="4">  商户码
								                </label>
											</div>
										</div>
									</div>
								</div>
								<div class="col-xs-12">
									<div class="col-xs-6">
										<label for="" class="col-sm-2 control-label" style="line-height:34px;">可用充值方式</label>
										<div class="col-sm-10">
											<div class="form-group" style="margin-top:10px;">
												<label style="line-height:20px;">
								                  <input type="checkbox" name="rechargeType" class="flat-red" value="1">  支付宝个码
								                </label>

												<label style="line-height:20px;">
								                  <input type="checkbox" name="rechargeType" class="flat-red" value="2">  微信个码
								                </label>
								                <label style="line-height:20px;">
								                  <input type="checkbox" name="rechargeType" class="flat-red" value="3">  银行卡
								                </label>
								                <label style="line-height:20px;">
								                  <input type="checkbox" name="rechargeType" class="flat-red" value="4">  商户码
								                </label>
											</div>
										</div>
									</div>

								</div>
								<div class="col-xs-12">
									<div class="col-xs-6">
										<label for="" class="col-sm-2 control-label" style="line-height:34px;">可用提现方式</label>
										<div class="col-sm-10">
											<div class="form-group" style="margin-top:10px;">
												<label style="line-height:20px;">
								                  <input type="checkbox" name="drawType" class="flat-red" value="1">  支付宝个码
								                </label>

												<label style="line-height:20px;">
								                  <input type="checkbox" name="drawType" class="flat-red" value="2">  微信个码
								                </label>
								                <label style="line-height:20px;">
								                  <input type="checkbox" name="drawType" class="flat-red" value="3">  银行卡
								                </label>
								                <label style="line-height:20px;">
								                  <input type="checkbox" name="drawType" class="flat-red" value="4">  商户码
								                </label>
											</div>
										</div>
									</div>

								</div>
							</div>
							<button class="btn btn-flat margin btn-success" id="save">保存</button>
						</div>
					</div>
				</section>
			</div>
		</div>
		<script src="bower_components/jquery/dist/jquery.min.js"></script>
		<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
		<script src="dist/js/adminlte.min.js"></script>

		<script src="bower_components/datatables.net/js/jquery.dataTables.min.js"></script>
		<script src="bower_components/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
		<script src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
		<!--选择框-->
		<script src="plugins/iCheck/icheck.min.js"></script>
		<!--<script src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>-->
		<script src="plugins/timepicker/bootstrap-timepicker.min.js"></script>
		<script src="bower_components/moment/min/moment.min.js"></script>
		<script src="bower_components/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
		<script src="js/fr.js"></script>
		<script src="js/fr_func.js"></script>
		<script src="js/nav.js"></script>
		<script type="text/javascript">
			$(function() {
				
				
				
				//获取
				$.ajax({
					type: "post",
					url: url + "/system/systemSettingInfo",
					async: true,
					contentType: "application/json",
					dataType: 'json',
					data: JSON.stringify({
						token: localStorage.getItem('fr_token'),
					}),
					success: function(res) {
						if(res.returnCode == 501) {
							ToLogin(res)
						} else if(res.returnCode == 200) {
							$.each(res.data.incomeSettingInfo, function(index, item) {
								$.each(item, function(key, items) {
									if(key == "id") {
										$("#incomeSettingInfo").find("tr").eq(index + 1).attr("set_id", items)
									} else {
										$("#incomeSettingInfo").find("tr").eq(index + 1).find("[name=" + key + "]").val(items);
									}
								})

							})
							$.each(res.data.systemSettingInfo, function(index, item) {
								if(index == "id") {
									
								} else if(index=="codeType"||index=="rechargeType"||index=="drawType"){
									console.log(item.split(","))
									$.each(item.split(","),function(key,items){
										$("[name=" + index + "][value=" + items + "]").iCheck('check');
									})
								}else if(index.indexOf("isOpen") == -1) {
									$("#" + index).val(item);
								} else{
									$("[name=" + index + "][value=" + item + "]").iCheck('check');
									
								}
							})

						} else {
							alert(res.msg);
						}
					}
				})
				//领导人奖励表格
				//修改
				$("#incomeSettingInfo input").change(function() {
					var tr = $(this).parents("tr")
					var param = {
						pushCount: tr.find("[name=pushCount]").val(), //直推人数
						incomeRate6: tr.find("[name=incomeRate6]").val(), //六代及以上抽成(百分比)
						id: tr.attr("set_id"), //设置id
						incomeRate5: tr.find("[name=incomeRate5]").val(), //五代抽成
						incomeRate4: tr.find("[name=incomeRate4]").val(), //四代抽成
						incomeRate3: tr.find("[name=incomeRate3]").val(), //三代抽成
						incomeRate2: tr.find("[name=incomeRate2]").val(), //二代抽成
						incomeRate1: tr.find("[name=incomeRate1]").val(), //一代抽成
						token: localStorage.getItem('fr_token'),
					}
					$.ajax({
						type: "post",
						url: url + "system/updateIncomeLevelInfo",
						async: true,
						contentType: "application/json",
						dataType: 'json',
						data: JSON.stringify(param),
						success: function(res) {
							if(res.returnCode == 501) {
								ToLogin(res)
							} else if(res.returnCode == 200) {

							} else {
								alert(res.msg);
							}
						}
					})
				})

				$('input[type="checkbox"].flat-red, input[type="radio"].flat-red').iCheck({
					checkboxClass: 'icheckbox_flat-green',
					radioClass: 'iradio_flat-green'
				})
				
				
				function valToStr($_name){
					var arr=[];
					$.each($_name,function(index,item){
						arr.push($_name.eq(index).val());
					})
					return arr.join(",");
				}

				$("#save").click(function() {
					var tr = $(this).parents("tr")
					var param = {
						//注册
						closePoint: $("#closePoint").val(),
						isOpenRegister: $("input[name=isOpenRegister]:checked").val(),

						//所有人奖励
						belongUserIncomeRate: $("#belongUserIncomeRate").val(), //订单所有人奖励比例

						//领导人奖励设置
						leaderUserIncomeRate: $("#leaderUserIncomeRate").val(), //领导人收益比例
						isOpenLeaderUserIncome: $("input[name=isOpenLeaderUserIncome]:checked").val(), //是否开启领导人奖励 1-开启 -1关闭

						//激活账号价格设置
						activeMoney: $("#activeMoney").val(), //激活账户金额
						isOpenActiveMoney: $("input[name=isOpenActiveMoney]:checked").val(), //是否开启激活账号金额 1-开启 -1-关闭

						//最低充值金额设置
						minRechargeMoney: $("#minRechargeMoney").val(), //最低充值金额
						isOpenMinRechargeMoney: $("input[name=isOpenMinRechargeMoney]:checked").val(), //是否开启最低充值金额 1-开启 -1-关闭

						//收益转信用最低金额设置
						incomeMinMoney: $("#incomeMinMoney").val(), //收益转信用点最低金额
						isOpenMinIncomeToCreditMoney: $("input[name=isOpenMinIncomeToCreditMoney]:checked").val(), //是否开启收益转信用点最低金额 1-开启 -1-关闭

						//提现最低金额设置
						minDrawMoney: $("#minDrawMoney").val(), //提现最低金额
						isOpenMinDrawMoney: $("input[name=isOpenMinDrawMoney]:checked").val(), //是否开启提现最低金额  1-开启 -1-关闭

						//提现手续费
						drawHandlingFee: $("#drawHandlingFee").val(), //提现手续费
						isOpenDrawHandlingFee: $("input[name=isOpenDrawHandlingFee]:checked").val(), //是否开启提现手续费 1-开启 -1关闭

						//收益分配最低信用点
						hasIncomeMoneyCredit: $("#hasIncomeMoneyCredit").val(), //收益分配最低信用点
						isOpenHasIncomeMinMoney: $("input[name=isOpenHasIncomeMinMoney]:checked").val(), //是否开启收益分配最低信用点设置 1-开启 -1-关闭

//						isOpenBankRecharge: $("input[name=isOpenBankRecharge]:checked").val(),
//						isOpenUSDTRecharge: $("input[name=isOpenUSDTRecharge]:checked").val(),
						//			            creditMinMoney: $("#creditMinMoney").val(), //获得收益所需最低信用额度

						transferFee:$("input[name=transferFee]").val(),//转账手续费
						outTime:$("input[name=outTime]").val(),//订单超时时间
						isOpenOutTime:$("input[name=isOpenOutTime]:checked").val(),
						
						token: localStorage.getItem('fr_token'),
						
						codeType:valToStr($("input[name=codeType]:checked")),
						rechargeType:valToStr($("input[name=rechargeType]:checked")),
						drawType:valToStr($("input[name=drawType]:checked")),
						//			     		
					}
					
					$.ajax({
						type: "post",
						url: url + "system/updateSettingInfo",
						async: true,
						contentType: "application/json",
						dataType: 'json',
						data: JSON.stringify(param),
						success: function(res) {
							if(res.returnCode == 501) {
								ToLogin(res)
							} else if(res.returnCode == 200) {
								alert(res.msg);
							} else {
								alert(res.msg);
							}
						}
					})
				})

				//				var string="<div id='msg'></div>"
				//				$("body").append(string);
				//				var option;
				//				var time = setTimeout(function(){
				//					$("#msg").css()
				//				},1000)

			})
		</script>
	</body>

</html>