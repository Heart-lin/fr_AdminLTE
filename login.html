<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<title>AdminLTE 2 | Log in</title>
		<!-- Tell the browser to be responsive to screen width -->
		<meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
		<!-- Bootstrap 3.3.7 -->
		<link rel="stylesheet" href="bower_components/bootstrap/dist/css/bootstrap.min.css">
		<!-- Font Awesome -->
		<link rel="stylesheet" href="bower_components/font-awesome/css/font-awesome.min.css">
		<!-- Ionicons -->
		<link rel="stylesheet" href="bower_components/Ionicons/css/ionicons.min.css">
		<!-- Theme style -->
		<link rel="stylesheet" href="dist/css/AdminLTE.min.css">
		<!-- iCheck -->
		<link rel="stylesheet" href="plugins/iCheck/square/blue.css">
		<link rel="stylesheet" href="css/fr_login.css">
		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->

		<!-- Google Font -->
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600,700,300italic,400italic,600italic">
	</head>
	<!--<body class="hold-transition login-page">-->

	<body class="hold-transition">
		<div class="login-box">
			<div class="login-logo">
				<a><b>Admin</b>分润系统</a>
			</div>
			<!-- /.login-logo -->

			<div class="login-box-body">
				<div class="fr_tab">
					<ul>
						<li class="action">账户密码登录</li>
						<li>手机登录</li>
					</ul>
				</div>
				<!--<form action="../../index2.html" method="post">-->

				<!--<form  method="post">-->
				<div class="fr_tab_body">
					<div class="form-group has-feedback">
						<input type="phone" id="account" class="form-control" placeholder="账户">
						<span class="glyphicon glyphicon-phone form-control-feedback"></span>
					</div>
					<div class="form-group has-feedback">
						<input type="password" id="password" class="form-control" placeholder="密码">
						<span class="glyphicon glyphicon-lock form-control-feedback"></span>
					</div>
				</div>
				<div class="fr_tab_body" style="display:none;">
					<div class="form-group has-feedback">
						<input type="phone" id="phone" class="form-control" placeholder="手机号">
						<span class="glyphicon glyphicon-phone form-control-feedback"></span>
					</div>
					<div class="form-group has-feedback">
						<div class="row">
							<div class="col-xs-7">
								<input type="password" id="code" class="form-control" placeholder="验证码">
								<!--<span class="glyphicon glyphicon-code form-control-feedback"></span>-->
							</div>
							<div class="col-xs-5">
								<button class="btn btn-primary btn-block btn-flat">获取验证码</button>
							</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-xs-8">
						<div class="checkbox icheck">
							<label>
              <input type="checkbox"> 同意协议
            </label>
						</div>
					</div>
					<!-- /.col -->
					<div class="col-xs-4">
						<div style="margin:10px 0;min-height:20px;line-height:20px;text-align:right;">
							<a href="javascript:;">忘记密码</a>
						</div>

					</div>
					<div class="col-xs-12">
						<div style="margin-top:20px;">
							<button type="submit" id="login" class="btn btn-primary btn-block btn-flat">登录</button>
						</div>
					</div>
					<div class="col-xs-8">
						<div class="social-auth-links">
							<p>其他登录方式
								<a href="#" class="fr_circle"><i class="fa fa-facebook"></i></a>
								<a href="#" class="fr_circle"><i class="fa fa-google-plus"></i></a>
							</p>
						</div>
					</div>
					<div class="col-xs-4">
						<div class="social-auth-links">
							<a href="register.html" class="text-right">
								<p>注册账户</p>
							</a>
						</div>
					</div>
					<!-- /.col -->
				</div>
			</div>
			<div class="modal fade" id="modal-default">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span></button>
							<h4 class="modal-title">登录确认</h4>
						</div>
						<div class="modal-body">
							 <form role="form">
              <div class="box-body">
                <div class="form-group">
                	<p id="model-phone" style="font-size:18px;">----</p>
                  <input type="code" class="form-control" id="model-code" placeholder="请输入短信验证码">
                </div>
              </div>
              <!-- /.box-body -->
            </form>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default pull-left" data-dismiss="modal">关闭</button>
							<button type="button" class="btn btn-primary" id="model-next">继续登录</button>
							<!--data-dismiss="modal"-->
						</div>
					</div>
					<!-- /.modal-content -->
				</div>
				<!-- /.modal-dialog -->
			</div>
			<!-- /.login-box-body -->
		</div>
		<!-- /.login-box -->

		<!-- jQuery 3 -->
		<script src="bower_components/jquery/dist/jquery.min.js"></script>
		<!-- Bootstrap 3.3.7 -->
		<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
		<!-- iCheck -->
		<script src="plugins/iCheck/icheck.min.js"></script>
		<script src="js/fr.js"></script>
		<script>
			$(function() {
				
				
				$('input').iCheck({
					checkboxClass: 'icheckbox_square-blue',
					radioClass: 'iradio_square-blue',
					increaseArea: '20%' /* optional */
				});

				$(".fr_tab li").click(function() {
					if($(this).index() == 1) {
						alert("功能暂未开放");
						return false;
					}
					//  	if(!$(this).hasClass("action")){
					//  		$(this).addClass("action").siblings().removeClass("action")
					//  		$(".fr_tab_body").eq($(this).index()).show().siblings(".fr_tab_body").hide();
					//  	}

				})
				
				$("#login").click(function() {
					var param = {};
					if($(".fr_tab li.action").index() == 0) {
						param = {
							account: $("#account").val(),
							password: $("#password").val()
						}
					} else if($(".fr_tab li.on").index() == 1) {

					}

					$.ajax({
						type: "post",
						url: url + "/managerLogin/login",
						//  		async:"true",
						data: JSON.stringify(param),
						contentType: "application/json",
						dataType: "json",
						success: function(res) {
							if(res.returnCode == 502) {
								$("#model-phone").html(res.data);
								$('#modal-default').modal('show');
								//调出弹框,显示返回的手机号码(脱敏),并提示用户输入该手机号码收到的短信验证码,
							} else if(res.returnCode == 200) {
								localStorage.setItem("fr_menu",JSON.stringify(res.menuData));
								localStorage.setItem("fr_name",res.data.name);
								localStorage.setItem("fr_phone",res.data.phone);
								localStorage.setItem("fr_token",res.data.token);
								localStorage.setItem("fr_roleId",res.data.roleId);
								localStorage.setItem("fr_managerId",res.data.managerId);
								window.location.href = "home.html";
							} else {
								alert(res.msg);
							}
						}
					})
				})
				
				$("#model-next").click(function(){
					$('#modal-default').modal('hide');
					param = {
						account: $("#account").val(),
						password: $("#password").val(),
						smsCode:$("#model-code").val()
					}
					$.ajax({
						type: "post",
						url: url + "/managerLogin/login",
						//  		async:"true",
						data: JSON.stringify(param),
						contentType: "application/json",
						dataType: "json",
						success: function(res) {
							if(res.returnCode == 502) {
								$("#model-phone").html(res.data);
								$('#modal-default').modal('show');
								//调出弹框,显示返回的手机号码(脱敏),并提示用户输入该手机号码收到的短信验证码,
							} else if(res.returnCode == 200) {
								localStorage.setItem("fr_name",res.data.name);
								localStorage.setItem("fr_phone",res.data.phone);
								localStorage.setItem("fr_token",res.data.token);
								localStorage.setItem("fr_menu",JSON.stringify(res.menuData));
								window.location.href = "home.html";
							} else {
								alert(res.msg);
							}
						}
					})
				})
			});
		</script>
	</body>

</html>